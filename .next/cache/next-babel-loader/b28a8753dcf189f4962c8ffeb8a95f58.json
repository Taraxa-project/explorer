{"ast":null,"code":"import config from 'config';\nimport mongoose from 'mongoose';\nimport Block from '../../../models/block';\nexport default async function userHandler(req, res) {\n  try {\n    await mongoose.connect(config.mongo.uri, config.mongo.options);\n  } catch (e) {\n    res.json({\n      error: 'Internal error. Please try your request again.'\n    }).status(500);\n    process.exit();\n  }\n\n  const {\n    query: {\n      id\n    },\n    method\n  } = req;\n\n  switch (method) {\n    case 'GET':\n      try {\n        const block = await Block.findOne({\n          _id: id\n        });\n\n        if (block) {\n          return res.json(block);\n        }\n\n        return res.status(404).json({\n          error: 'Not found'\n        });\n      } catch (e) {\n        console.error(e);\n        res.status(500).json({\n          error: 'Internal error. Please try your request again.'\n        });\n      }\n\n      break;\n\n    default:\n      res.setHeader('Allow', ['GET']);\n      res.status(405).end(`Method ${method} Not Allowed`);\n  }\n}","map":{"version":3,"sources":["/home/user1/Development/taraxa/explorer-api/pages/api/block/[id].js"],"names":["config","mongoose","Block","userHandler","req","res","connect","mongo","uri","options","e","json","error","status","process","exit","query","id","method","block","findOne","_id","console","setHeader","end"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,QAAnB;AACA,OAAOC,QAAP,MAAqB,UAArB;AAEA,OAAOC,KAAP,MAAkB,uBAAlB;AAEA,eAAe,eAAeC,WAAf,CAA2BC,GAA3B,EAAgCC,GAAhC,EAAqC;AAChD,MAAI;AACA,UAAMJ,QAAQ,CAACK,OAAT,CAAiBN,MAAM,CAACO,KAAP,CAAaC,GAA9B,EAAmCR,MAAM,CAACO,KAAP,CAAaE,OAAhD,CAAN;AACH,GAFD,CAEE,OAAOC,CAAP,EAAU;AACRL,IAAAA,GAAG,CAACM,IAAJ,CAAS;AAACC,MAAAA,KAAK,EAAE;AAAR,KAAT,EAAoEC,MAApE,CAA2E,GAA3E;AACAC,IAAAA,OAAO,CAACC,IAAR;AACH;;AACD,QAAM;AACFC,IAAAA,KAAK,EAAE;AAACC,MAAAA;AAAD,KADL;AAEFC,IAAAA;AAFE,MAGFd,GAHJ;;AAKA,UAAQc,MAAR;AACI,SAAK,KAAL;AACI,UAAI;AACA,cAAMC,KAAK,GAAG,MAAMjB,KAAK,CAACkB,OAAN,CAAc;AAACC,UAAAA,GAAG,EAAEJ;AAAN,SAAd,CAApB;;AACA,YAAIE,KAAJ,EAAW;AACP,iBAAOd,GAAG,CAACM,IAAJ,CAASQ,KAAT,CAAP;AACH;;AACD,eAAOd,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBF,IAAhB,CAAqB;AAACC,UAAAA,KAAK,EAAE;AAAR,SAArB,CAAP;AACH,OAND,CAME,OAAOF,CAAP,EAAU;AACRY,QAAAA,OAAO,CAACV,KAAR,CAAcF,CAAd;AACAL,QAAAA,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBF,IAAhB,CAAqB;AAACC,UAAAA,KAAK,EAAE;AAAR,SAArB;AACH;;AACD;;AACJ;AACIP,MAAAA,GAAG,CAACkB,SAAJ,CAAc,OAAd,EAAuB,CAAC,KAAD,CAAvB;AACAlB,MAAAA,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBW,GAAhB,CAAqB,UAASN,MAAO,cAArC;AAfR;AAiBH","sourcesContent":["import config from 'config';\nimport mongoose from 'mongoose';\n\nimport Block from '../../../models/block';\n\nexport default async function userHandler(req, res) {\n    try {\n        await mongoose.connect(config.mongo.uri, config.mongo.options);\n    } catch (e) {\n        res.json({error: 'Internal error. Please try your request again.'}).status(500);\n        process.exit();\n    }\n    const {\n        query: {id},\n        method,\n    } = req;\n\n    switch (method) {\n        case 'GET':\n            try {\n                const block = await Block.findOne({_id: id});\n                if (block) {\n                    return res.json(block);\n                }\n                return res.status(404).json({error: 'Not found'});\n            } catch (e) {\n                console.error(e);\n                res.status(500).json({error: 'Internal error. Please try your request again.'});\n            }\n            break;\n        default:\n            res.setHeader('Allow', ['GET']);\n            res.status(405).end(`Method ${method} Not Allowed`);\n    }\n}\n"]},"metadata":{},"sourceType":"module"}