{"ast":null,"code":"import config from 'config';\nimport mongoose from 'mongoose';\nimport Block from '../../../models/block';\nexport default async function handler(req, res) {\n  if (mongoose.connection._readyState === 0) {\n    try {\n      await mongoose.connect(config.mongo.uri, config.mongo.options);\n    } catch (e) {\n      res.json({\n        error: 'Internal error. Please try your request again.'\n      }).status(500);\n      process.exit();\n    }\n  }\n\n  let skip = Number(req.query.skip) || 0;\n  let limit = Number(req.query.limit) || 20;\n  let reverse = Boolean(req.query.reverse);\n\n  try {\n    const blocks = await Block.find().limit(limit).skip(skip).sort({\n      number: reverse ? -1 : 1\n    });\n    res.json(blocks);\n  } catch (e) {\n    console.error(e);\n    res.json({\n      error: 'Internal error. Please try your request again.'\n    }).status(500);\n  }\n}","map":null,"metadata":{},"sourceType":"module"}