{"ast":null,"code":"import config from 'config';\nimport mongoose from 'mongoose';\nimport Block from '../../../models/block';\nexport default async function userHandler(req, res) {\n  if (mongoose.connection._readyState === 0) {\n    try {\n      await mongoose.connect(config.mongo.uri, config.mongo.options);\n    } catch (e) {\n      res.json({\n        error: 'Internal error. Please try your request again.'\n      }).status(500);\n      process.exit();\n    }\n  }\n\n  const {\n    query: {\n      id\n    },\n    method\n  } = req;\n\n  switch (method) {\n    case 'GET':\n      try {\n        const block = await Block.findOne({\n          _id: id\n        });\n\n        if (block) {\n          return res.json(block);\n        }\n\n        return res.json({\n          error: 'Not found'\n        }).statusCode(404);\n      } catch (e) {\n        console.error(e);\n        res.json({\n          error: 'Internal error. Please try your request again.'\n        }).status(500);\n      }\n\n      break;\n\n    default:\n      res.setHeader('Allow', ['GET']);\n      res.status(405).end(`Method ${method} Not Allowed`);\n  }\n}","map":null,"metadata":{},"sourceType":"module"}